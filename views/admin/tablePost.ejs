<div>
    <div>
        <button type="button" class="btn btn-primary" data-target="#postForm" data-toggle="modal"> thêm mới bài
            đăng</button>
        <div class="modal fade" id="postForm" %> tabindex="-1" role="dialog"
            aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content card-body">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">tạo bài post mới</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form enctype="multipart/form-data" class="form-horizontal forms-sample" method="post"
                            action=<%=url+"/adminPost" %>>
                            <div class="form-group">
                                <label for="email" class="cols-sm-2 control-label">người hướng dẫn</label>
                                <div class="cols-sm-10">
                                    <div class="input-group">
                                        <span class="input-group-addon"><i class="fa fa-envelope fa"
                                                aria-hidden="true"></i></span>
                                        <select name="tourGuideID" class="form-control form-control-lg"
                                            id="exampleFormControlSelect1">
                                            <% tourGuide.forEach(function(tourGD){ %>
                                            <option value=<%=tourGD._id %>> <%=tourGD.username %> </option>
                                            <%})%>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="username" class="cols-sm-2 control-label">tên địa điểm</label>
                                <div class="cols-sm-10">
                                    <div class="input-group">
                                        <span class="input-group-addon"><i class="fa fa-users fa"
                                                aria-hidden="true"></i></span>
                                        <select name="localtionID" class="form-control" id="exampleFormControlSelect1">
                                            <% location.forEach(function(locationDetail){ %>
                                            <option value=<%=locationDetail._id %>> <%=locationDetail.nameLocation %>
                                            </option>
                                            <%})%>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="name" class="cols-sm-2 control-label">post name</label>
                                <div class="cols-sm-10">
                                    <div class="input-group">
                                        <span class="input-group-addon"><i class="fa fa-user fa"
                                                aria-hidden="true"></i></span>
                                        <input type="text" class="form-control" name="name" />
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="password" class="cols-sm-2 control-label">description</label>
                                <div class="cols-sm-10">
                                    <div class="input-group">
                                        <span class="input-group-addon"><i class="fa fa-lock fa-lg"
                                                aria-hidden="true"></i></span>
                                        <input type="text" class="form-control" name="description" />
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="password" class="cols-sm-2 control-label">content</label>
                                <div class="cols-sm-10">
                                    <div class="input-group">
                                        <span class="input-group-addon"><i class="fa fa-lock fa-lg"
                                                aria-hidden="true"></i></span>
                                        <input type="text" class="form-control" name="content" />
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="password" class="cols-sm-2 control-label">plan</label>
                                <div class="cols-sm-10">
                                    <div class="input-group">
                                        <span class="input-group-addon"><i class="fa fa-lock fa-lg"
                                                aria-hidden="true"></i></span>
                                        <input type="text" class="form-control" name="plan" />
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="password" class="cols-sm-2 control-label">price</label>
                                <div class="cols-sm-10">
                                    <div class="input-group">
                                        <span class="input-group-addon"><i class="fa fa-lock fa-lg"
                                                aria-hidden="true"></i></span>
                                        <input type="number" class="form-control" name="price" />
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="password" class="cols-sm-2 control-label">image</label>
                                <div class="cols-sm-10">
                                    <div class="input-group">
                                        <span class="input-group-addon"><i class="fa fa-lock fa-lg"
                                                aria-hidden="true"></i></span>
                                        <input type="file" class="form-control" name="image" />
                                    </div>
                                </div>
                            </div>
                            <div class="form-group ">
                                <button type="submit"
                                    class="btn btn-primary btn-lg btn-block login-button">post</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <table class="table table-hover">
        <thead>
            <tr>
                <th scope="col">tourGuideID</th>
                <th scope="col">location</th>
                <th scope="col">price</th>
                <th scope="col">image</th>
                <th scope="col">status</th>
                <th scope="col">name post</th>
            </tr>
        </thead>
        <tbody>
            <% let i = 0; %>
            <% post.forEach(function(item){ %>
            <% i++; %>
            <tr>
                <th><%= item.tourGuideID.username; %></th>
                <th><%= item.localtionID.nameLocation %></th>
                <th><%= item.price; %></th>
                <th><img src=<%=url+'/'+item.image[0]; %> height="200px" width="200px" /></th>
                <th><%= item.status; %></th>
                <th><%= item.name; %></th>
                <th>
                    <button type="button" class="btn btn-primary" data-target=<%='#haha'+i.toString(); %>
                        data-toggle="modal">Duyệt bài đăng</button>
                    <div class="modal fade bd-example-modal-xl" id=<%='haha'+i.toString() %> tabindex="-1" role="dialog"
                        aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-xl" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Chi tiết bài đăng</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <div class="card-body">
                                        <h4 class="card-title">Bài đăng </h4>
                                        <form class="form-sample" enctype="multipart/form-data" method="POST"
                                            action=<%= url +"/adminPost/update" %>>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label"> tên bài đăng </label>
                                                        <div class="col-sm-9">
                                                            <textarea type="text" name="name"
                                                                class="form-control"><%=item.name.toString(); %> </textarea>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">Nội dung</label>
                                                        <div class="col-sm-9">
                                                            <textarea type="text" name="content"
                                                                class="form-control"><%= item.content; %> </textarea>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">người dẫn tour</label>
                                                        <div class="col-sm-9">
                                                            <textarea type="text" name="tourGuideID"
                                                                class="form-control"readonly  ><%=item.tourGuideID._id;%></textarea>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">Địa điểm</label>
                                                        <div class="col-sm-9">
                                                            <select class="form-control form-control-lg"
                                                                name="localtionID">
                                                                <% location.forEach(function(locationDetail){ %>
                                                                <option value=<%=locationDetail._id %>>
                                                                    <%=locationDetail.nameLocation %>
                                                                </option>
                                                                <%})%>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">mô tả chuyến đi</label>
                                                        <div class="col-sm-9">
                                                            <textarea class="form-control" id="exampleTextarea1"
                                                                name="description"
                                                                rows="4"><%= item.description; %> </textarea>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">lịch trình chuyến
                                                            đi</label>
                                                        <div class="col-sm-9">
                                                            <textarea class="form-control" id="exampleTextarea1"
                                                                name="String" rows="4"><%= item.plan; %></textarea>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">giá của chuyển đi
                                                        </label>
                                                        <div class="col-sm-9">
                                                            <input type="text" class="form-control" name="price"
                                                                value=<%=item.price %>>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label"> Trạng thái </label>
                                                        <div class="col-sm-9">
                                                            <select class="form-control form-control-lg" name="status">
                                                                <option value="ACTIVE" selected> ACTIVE </option>
                                                                <option value="LOCK"> LOCK </option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="col-sm-3 col-form-label">hình ảnh</label>
                                                        <div class="col-sm-9">
                                                            <input type='file' id="imgInp" name="image" />
                                                            <img id="blah" src="#" alt="your image" width="200px"
                                                                height="200px" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div> <input type="hidden" name="_id" value=<%=item._id %>> </div>
                                    </div>
                                    <button type="submit" class="btn btn-info waves-effect waves-light">cập nhật
                                        <i class="fas fa-sign-in ml-1"></i>
                                    </button>
                                    </form>
                                </div>

                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
</div>
</th>
<th>
    <form action=<%= url +"/adminPost/update" %> method="post" enctype="multipart/form-data" >
        <div>
            <input type="hidden" name="isDelete" value="true">
            <input   type="hidden" name="_id" value=<%=item._id %> >
        </div>
        <div>
            <button type="submit" class="btn btn-primary"> Xoá bài đăng </button>
        </div>
    </form>
</th>
</tr>
<% }) %>
</tbody>
</table>

<script type="text/javascript">
    $(document).ready(function () {
        // $("#hahaha").click(async function (even) {
        //     let body = {};
        //     $('#hahaha').serializeArray().forEach(function (item) {
        //         if (item.name && item.value) {
        //             body[item.name] = item.value;
        //         }
        //     });
        //     let form = $(this);
        //     let url = form.attr('action')
        //     console.log(body);
        //     alert("lala");
        //     even.defaultPrevented();
        //     $.ajax({
        //         url: url,
        //         type: frm.attr('method'),
        //         dataType: 'json',
        //         contentType: "application/json",
        //         data: { "a": "b", "c": "d" },
        //         success: function (data) {
        //             console.log("getdataa");
        //             $.get('http://localhost:3000/adminPost');
        //         },
        //         error: function (err) {
        //             console.log(err);
        //         }
        //     });
        // });
        function readURL(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();
                console.log("hahahah");
                reader.onload = function (e) {
                    $('#blah').attr('src', e.target.result);
                }
                reader.readAsDataURL(input.files[0]);
            }
        }
        $("#imgInp").change(function () {
            readURL(this);
        });
    });
</script>